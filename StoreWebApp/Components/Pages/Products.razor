@page "/products/{PageNum:int}"
@using StoreWebApp.Components.Pieces
@inject Models.IProductRepository ProductRepository

<PageTitle>Products</PageTitle>

<h1>Products</h1>

@if (products != null)
{
    <!-- Flex container for product cards -->
    <div class="d-flex flex-wrap">
        @foreach (var product in products)
        {
            <ProductCard Product=@product />
        }
    </div>

    <StoreWebApp.Components.Pieces.Pagination PageNumber=@PageNum PageSize=20 />
}
else
{
    <p>No products found.</p>
}

@code {
    private IEnumerable<Models.Product>? products;
    [Parameter] public int PageNum { get; set; }

    protected override async Task OnInitializedAsync()
    {
        try
        {
            products = await ProductRepository.GetProductsAsync(PageNum, 20);
        }
        catch (Exception ex)
        {
            Console.WriteLine(ex.Message);
            products = null;
        }
    }
}
